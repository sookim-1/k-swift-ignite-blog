---
author: sookim-1
description: SwiftUI + TCA ëŠë‚€ì , URLComponent ì‚¬ìš©ì‹œ ì£¼ì˜ì‚¬í•­, Youtube API ì¬ìƒëª©ë¡ ê°€ì ¸ì˜¤ê¸°, Visioní”„ë ˆì„ì›Œí¬ë¥¼ í™œìš©í•˜ì—¬ Text ì¶”ì¶œí•˜ê¸°
date: 2024-09-09 19:00
tags: iOS, Swift, SwiftUI, TCA, URLSession, Vision, OCR, Youtube
published: true
---
# ë²ˆí˜¸ : 032, ì‘ì„±ì¼ì: 2024-09-09
## 2024.09.03 ~ 2024.09.08
### ğŸ¬Â SwiftUI + TCA (The Composable Architecture)

---

ê¸°ì¡´ UIKit í”„ë¡œì íŠ¸ì—ì„œ SwiftUI + TCAë¥¼ ì ìš©í•œ í™”ë©´ì„ ì ìš©í•˜ê¸° ìœ„í•´ ê°œë°œì„ í–ˆë‹¤.

ì¼ë‹¨ SwiftUIë¥¼ ì‚¬ìš©í•˜ë©° ëŠë¼ëŠ” ì ì€ í¸ë¦¬í•œ ë¶€ë¶„ì´ ë§ë‹¤ëŠ” ì ì´ì˜€ë‹¤.

UIComponentë¥¼ ë¶„ë¦¬ ì‘ì—…, SwiftUI ì½”ë“œê°€ UIKitë³´ë‹¤ ì½”ë“œ ì¤„ì´ ì ì–´ì„œ ê°€ë…ì„±ì´ ì¢‹ì•˜ê³ , ChatGPT í™œìš©ë„, Preview ì†ë„ë“± UI ê°œë°œì‹œê°„ì´ ë‹¨ì¶•ë˜ëŠ” ëŠë‚Œì´ë‹¤.

TCAëŠ” API ì²˜ë¦¬ í•  ë•Œ request, responseë“± Actionì´ 2ê°œ ì´ìƒ ì¶”ê°€í•´ì•¼í•´ì„œ ì¡°ê±´ì´ ë§ì§€ ì•Šì„ ê¹Œ ìƒê°í•´ë´¤ëŠ”ë° í•´ë‹¹ ì•„í‚¤í…ì²˜ë¼ì´ë¸ŒëŸ¬ë¦¬ì—ì„œ ë‹¨ë°©í–¥ì„ ì§€í‚¤ê¸° ìœ„í•œ ë¶€ë¶„ì´ë¼ê³  ìƒê°í–ˆë‹¤.

### ğŸ“·Â Text OCR

---

ì‚¬ì§„ì—ì„œ Textë¥¼ ì¶”ì¶œí•˜ê¸° ìœ„í•´ì„œ ì—¬ëŸ¬ê°€ì§€ Toolì´ ìˆë‹¤.(Google ML Kit, NHNCloud OCR, Vision)

ê·¸ ì¤‘ Vision í”„ë ˆì„ì›Œí¬ëŠ” Appleì—ì„œ ì œê³µí•˜ëŠ” í”„ë ˆì„ì›Œí¬ì—¬ì„œ í•´ë‹¹ í”„ë ˆì„ì›Œí¬ë¥¼ ì‚¬ìš©í•´ì„œ í…ìŠ¤íŠ¸ì¶”ì¶œì„ ì‹œë„í•´ë´¤ë‹¤.

ì´ë¦„ì´ ë¹„ìŠ·í•œ VisionKití”„ë ˆì„ì›Œí¬ë„ ìˆëŠ”ë°, í•´ë‹¹ í”„ë ˆì„ì›Œí¬ë¥¼ ê°™ì´ ì‚¬ìš©í•˜ë©´ VNDocumentCameraViewControllerë¥¼ ì‚¬ìš©í•˜ì—¬ ì˜ì—­ì„ ì¸ì‹í•´ì£¼ê³  ì´ë¯¸ì§€ë¥¼ ì¶”ì¶œí•˜ë©´ Visioní”„ë ˆì„ì›Œí¬ë¥¼ ì´ìš©í•´ í•´ë‹¹ ì´ë¯¸ì§€ì—ì„œ í…ìŠ¤íŠ¸ë¥¼ ì¶”ì¶œí•  ìˆ˜ ìˆë‹¤.

í•˜ì§€ë§Œ, ì¹´ë©”ë¼ ìŠ¤ìº”í™”ë©´ì„ Customí•˜ê¸° ìœ„í•´ì„œëŠ” ì§ì ‘ VNDocumentCameraViewControllerë¥¼ Customí•˜ëŠ” ë°©ë²•ì€ ì•„ì§ ì—†ëŠ” ê²ƒ ê°™ë‹¤.

ê·¸ë˜ì„œ AVFoundationí”„ë ˆì„ì›Œí¬ë¥¼ í™œìš©í•˜ì—¬ ì¹´ë©”ë¼ë¥¼ ìº¡ì²˜í•œí›„ ì´ë¯¸ì§€ë¥¼ Visioní”„ë ˆì„ì›Œí¬ì— ì œê³µí–ˆëŠ”ë° ì¸ì‹ë¥ ì´ í˜„ì €íˆ ë–¨ì–´ì¡Œë‹¤. 

VisionKitì´ ì œê³µë˜ì§€ ì•Šì•˜ì„ ë•Œ ìì£¼ ì‚¬ìš©í•˜ë˜ ğŸ”—Â [YesWeScanë¼ì´ë¸ŒëŸ¬ë¦¬](https://github.com/adorsys/YesWeScan)ê°€ ìˆë‹¤ê³  í•´ì„œ ì´ë¯¸ì§€ë¥¼ ì œê³µí•˜ì—¬ í…ŒìŠ¤íŠ¸í•´ë³´ì•˜ëŠ”ë° VisionKitê³¼ ì¸ì‹ë¥ ì´ ë™ì¼í–ˆë‹¤.

í•´ë‹¹ ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ë¶„ì„í•˜ì—¬ ë‚´ê°€ ì²«ë²ˆì§¸ë¡œ ì‚¬ìš©í–ˆë˜ AVFoundationì—ì„œ ì„¤ì •í•˜ëŠ” ë¶€ë¶„ì—ì„œ ì°¨ì´ì ì„ ì°¾ì•„ë³´ê³  í™•ì¸í•´ë´ì•¼ê² ë‹¤.

### ğŸŒÂ Youtube Data API í™œìš©

---

ê°œë°œê³¼ ê´€ë ¨ëœ ìœ ìš©í•œ Youtubeì±„ë„ì˜ ì˜ìƒë“¤ì˜ ì‹œì²­ì—¬ë¶€ë¥¼ ì €ì¥í•˜ê¸° ìœ„í•´ Youtube Data APIë¥¼ í™œìš©í•´ì„œ ì¬ìƒëª©ë¡ì„ í…ìŠ¤íŠ¸íŒŒì¼ë¡œ ì •ë¦¬í•´ì£¼ëŠ” íŒŒì´ì¬ìŠ¤í¬ë¦½íŠ¸ë¥¼ ì‘ì„±í–ˆë‹¤.

ğŸ”—Â [Youtube API Docs - search](https://developers.google.com/youtube/v3/docs/search/list?hl=ko)

```python
import requests
import time

# Step 1: API ì„¤ì •
API_KEY = ''  # ì‹¤ì œ API í‚¤ ì‘ì„±
CHANNEL_ID = ''  # ì œëª©ì„ ê°€ì ¸ì˜¬ ì±„ë„ ID

MAX_RESULTS = 50  # í•œ ë²ˆì— ê°€ì ¸ì˜¬ ê²°ê³¼ ìˆ˜ (ìµœëŒ€ 50)

# ìœ íŠœë¸Œ ë°ì´í„° API v3 ê²€ìƒ‰ ì—”ë“œí¬ì¸íŠ¸ ê¸°ë³¸ URL
youtube_url = 'https://www.googleapis.com/youtube/v3/search'

# API ìš”ì²­ì— í•„ìš”í•œ ë§¤ê°œë³€ìˆ˜
params = {
    'part': 'snippet',
    'maxResults': MAX_RESULTS,
    'channelId': CHANNEL_ID,
    'type': 'video',
    'order': 'date',  # ê²°ê³¼ë¥¼ ë‚ ì§œìˆœìœ¼ë¡œ ì •ë ¬
    'key': API_KEY
}

# ë¹„ë””ì˜¤ ì œëª©ê³¼ URLì„ ê°€ì ¸ì˜¤ëŠ” í•¨ìˆ˜
def fetch_video_titles_and_urls():
    videosResult = []
    next_page_token = None

    while True:
        if next_page_token:
            params['pageToken'] = next_page_token

        # Step 2: ìœ íŠœë¸Œ ë°ì´í„° APIì— GET ìš”ì²­ ë³´ë‚´ê¸°
        response = requests.get(youtube_url, params=params)
        data = response.json()

        # Step 3: ë¹„ë””ì˜¤ ì œëª© ë° URL ì¶”ì¶œ
        for item in data['items']:
            title = item['snippet']['title']
            video_id = item['id']['videoId']
            video_url = f'https://www.youtube.com/watch?v={video_id}'
            videosResult.append((title, video_url))

        # ë‹¤ìŒ í˜ì´ì§€ê°€ ìˆëŠ”ì§€ í™•ì¸
        next_page_token = data.get('nextPageToken')

        # ë‹¤ìŒ í˜ì´ì§€ê°€ ìˆì„ ê²½ìš°, 61ì´ˆ ëŒ€ê¸°
        if next_page_token:
            time.sleep(61)

        if not next_page_token:
            break

    return videosResult

# ì œëª©ê³¼ URLì„ í…ìŠ¤íŠ¸ íŒŒì¼ì— ì €ì¥í•˜ëŠ” í•¨ìˆ˜
def save_titles_and_urls_to_file(videos, filename='video_titles_and_urls.txt'):
    with open(filename, 'w', encoding='utf-8') as file:
        for index, (title, url) in enumerate(videos, start=1):
            file.write(f"{index}. {title}\n- {url}\n\n")

# ì½”ë“œ ì‹¤í–‰
videos = fetch_video_titles_and_urls()
save_titles_and_urls_to_file(videos)

```

- ì›í•˜ëŠ” ì±„ë„IDë¥¼ ê²€ìƒ‰í•œ í›„ ë‹¤ìŒí˜ì´ì§€ê°€ ìˆë‹¤ë©´ í˜ì´ì§€ë¥¼ ê²€ìƒ‰í•˜ì—¬ ë™ì˜ìƒëª©ë¡ì„ ê°€ì ¸ì˜¨ í›„ video_titles_and_urls.txtíŒŒì¼ì— ì €ì¥í•˜ëŠ” ìŠ¤í¬ë¦½íŠ¸

### ğŸ™‹ğŸ»â€â™‚ï¸ ê¸°íƒ€ ì‚¬í•­

---

1. URLComponentsì— queryItemì— ì¶”ê°€í•˜ë©´ ìë™ìœ¼ë¡œ UTF-8í˜•ì‹ URLì¸ì½”ë”©ì„ ìë™ìœ¼ë¡œ í•´ì£¼ê¸° ë•Œë¬¸ì— ë”°ë¡œ ì²˜ë¦¬í•˜ë©´ ì¤‘ë³µ ì¸ì½”ë”©ì´ ë  ìˆ˜ ìˆë‹¤.
    
    ```swift
        func requestSearch(keyword: String) async throws -> Result<SampleDTO, SampleError> {
    				...
    				
            /* ì¤‘ë³µ
            guard let encodedKeyword = keyword.addingPercentEncoding(withAllowedCharacters: .urlQueryAllowed) else {
                return .failure(.invalidUrl)
            }
            */
    
            // queryì— ë„£ìœ¼ë©´ ìë™ìœ¼ë¡œ URL Encodingí•¨
            components?.queryItems = [
                URLQueryItem(name: "searchKeyword", value: keyword)
            ]
            
            ...
    ```
